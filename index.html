<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SkillGap AI ‚Äî Resume Analyser</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<style>
  :root {
    --bg: #0c0c0c;
    --bg2: #141414;
    --bg3: #1e1e1e;
    --bg4: #282828;
    --yellow: #f5c400;
    --yellow2: #ffd740;
    --green: #22c55e;
    --red: #ef4444;
    --orange: #f97316;
    --blue: #3b82f6;
    --text: #efefef;
    --muted: #666;
    --border: rgba(245,196,0,0.12);
    --border2: rgba(255,255,255,0.06);
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-thumb { background: var(--yellow); border-radius: 2px; }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    border-bottom: 1px solid var(--border);
    padding: 0 48px;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: rgba(12,12,12,0.95);
    backdrop-filter: blur(20px);
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.6rem;
    letter-spacing: 0.08em;
    color: var(--text);
  }

  .logo span { color: var(--yellow); }

  .header-badge {
    font-family: 'DM Mono', monospace;
    font-size: 0.65rem;
    color: var(--yellow);
    border: 1px solid var(--border);
    padding: 4px 12px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
  .hero {
    text-align: center;
    padding: 72px 48px 56px;
    position: relative;
    overflow: hidden;
  }

  .hero::before {
    content: 'SKILLGAP';
    position: absolute;
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(6rem, 18vw, 16rem);
    color: rgba(245,196,0,0.03);
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
    white-space: nowrap;
    letter-spacing: 0.06em;
  }

  .hero-tag {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(245,196,0,0.08);
    border: 1px solid var(--border);
    border-radius: 100px;
    padding: 6px 16px;
    font-family: 'DM Mono', monospace;
    font-size: 0.68rem;
    color: var(--yellow);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 24px;
  }

  .hero-tag-dot {
    width: 6px; height: 6px;
    background: var(--yellow);
    border-radius: 50%;
    animation: blink 1.5s ease infinite;
  }

  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.2} }

  .hero h1 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(2.8rem, 6vw, 5rem);
    letter-spacing: 0.04em;
    line-height: 1;
    color: var(--text);
    margin-bottom: 16px;
    position: relative;
  }

  .hero h1 span { color: var(--yellow); }

  .hero p {
    font-size: 1rem;
    color: var(--muted);
    max-width: 520px;
    margin: 0 auto 0;
    line-height: 1.75;
    font-weight: 300;
  }

  /* ‚îÄ‚îÄ MAIN TOOL ‚îÄ‚îÄ */
  .tool-wrapper {
    max-width: 1100px;
    margin: 0 auto;
    padding: 0 48px 80px;
  }

  /* ‚îÄ‚îÄ UPLOAD GRID ‚îÄ‚îÄ */
  .upload-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 24px;
  }

  .upload-card {
    background: var(--bg2);
    border: 1px solid var(--border2);
    border-radius: 4px;
    overflow: hidden;
    transition: border-color 0.25s;
  }

  .upload-card:focus-within { border-color: var(--border); }

  .upload-card-header {
    background: var(--bg3);
    padding: 14px 20px;
    display: flex;
    align-items: center;
    gap: 10px;
    border-bottom: 1px solid var(--border2);
  }

  .card-icon {
    width: 28px; height: 28px;
    background: rgba(245,196,0,0.1);
    border: 1px solid var(--border);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.85rem;
    flex-shrink: 0;
  }

  .card-title {
    font-family: 'DM Mono', monospace;
    font-weight: 500;
    font-size: 0.72rem;
    color: var(--text);
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  .card-subtitle {
    font-size: 0.7rem;
    color: var(--muted);
    margin-left: auto;
  }

  /* Drop Zone */
  .drop-zone {
    padding: 28px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    cursor: pointer;
    transition: background 0.2s;
    border: 2px dashed transparent;
    margin: 12px;
    border-radius: 4px;
    min-height: 120px;
  }

  .drop-zone:hover { background: rgba(245,196,0,0.03); border-color: var(--border); }
  .drop-zone.dragover { background: rgba(245,196,0,0.06); border-color: var(--yellow); }
  .drop-zone.has-file { border-color: var(--green); background: rgba(34,197,94,0.04); }

  .drop-icon { font-size: 1.8rem; opacity: 0.5; }

  .drop-text {
    font-size: 0.82rem;
    color: var(--muted);
    text-align: center;
    line-height: 1.5;
  }

  .drop-text strong { color: var(--yellow); font-weight: 600; cursor: pointer; }
  .drop-text strong:hover { text-decoration: underline; }

  .file-chosen {
    font-family: 'DM Mono', monospace;
    font-size: 0.7rem;
    color: var(--green);
    display: flex;
    align-items: center;
    gap: 6px;
  }

  input[type="file"] { display: none; }

  /* Divider */
  .or-divider {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 0 20px 12px;
  }

  .or-divider::before, .or-divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border2);
  }

  .or-divider span {
    font-family: 'DM Mono', monospace;
    font-size: 0.65rem;
    color: var(--muted);
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  /* Textarea */
  .paste-area {
    background: transparent;
    border: none;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.85rem;
    font-weight: 300;
    line-height: 1.7;
    padding: 12px 20px 20px;
    width: 100%;
    resize: none;
    outline: none;
    min-height: 130px;
  }

  .paste-area::placeholder { color: var(--muted); font-style: italic; }

  /* ‚îÄ‚îÄ ANALYSE BUTTON ‚îÄ‚îÄ */
  .analyse-btn {
    width: 100%;
    background: var(--yellow);
    color: #000;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.3rem;
    letter-spacing: 0.12em;
    padding: 18px;
    border: none;
    cursor: pointer;
    transition: all 0.25s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 12px 100%, 0 calc(100% - 12px));
    margin-bottom: 48px;
  }

  .analyse-btn:hover { background: var(--yellow2); transform: translateY(-2px); box-shadow: 0 8px 32px rgba(245,196,0,0.25); }
  .analyse-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none; }

  .btn-arrow { font-size: 1.1rem; transition: transform 0.2s; }
  .analyse-btn:hover .btn-arrow { transform: translateX(4px); }

  /* ‚îÄ‚îÄ LOADING ‚îÄ‚îÄ */
  .loading-state {
    display: none;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    padding: 60px 0;
    text-align: center;
  }

  .loading-state.active { display: flex; }

  .loader {
    width: 48px; height: 48px;
    border: 3px solid var(--border2);
    border-top-color: var(--yellow);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  .loading-text {
    font-family: 'DM Mono', monospace;
    font-size: 0.78rem;
    color: var(--muted);
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  .loading-steps {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 8px;
  }

  .loading-step {
    font-size: 0.82rem;
    color: var(--muted);
    opacity: 0;
    transform: translateY(8px);
    transition: all 0.4s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .loading-step.show { opacity: 1; transform: translateY(0); }
  .loading-step.done { color: var(--green); }
  .loading-step .step-icon { font-size: 0.9rem; }

  /* ‚îÄ‚îÄ RESULTS ‚îÄ‚îÄ */
  .results-section { display: none; }
  .results-section.active { display: block; }

  /* Match Score Banner */
  .match-banner {
    background: var(--bg2);
    border: 1px solid var(--border2);
    border-radius: 4px;
    padding: 32px 40px;
    display: flex;
    align-items: center;
    gap: 40px;
    margin-bottom: 20px;
    position: relative;
    overflow: hidden;
  }

  .match-banner::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--yellow), var(--yellow2));
  }

  .match-score-wrap { text-align: center; flex-shrink: 0; }

  .match-score {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 4.5rem;
    line-height: 1;
    color: var(--yellow);
    letter-spacing: -0.02em;
  }

  .match-label {
    font-family: 'DM Mono', monospace;
    font-size: 0.65rem;
    color: var(--muted);
    letter-spacing: 0.14em;
    text-transform: uppercase;
    margin-top: 4px;
  }

  .match-bar-wrap { flex: 1; }

  .match-bar-label {
    display: flex;
    justify-content: space-between;
    font-family: 'DM Mono', monospace;
    font-size: 0.68rem;
    color: var(--muted);
    letter-spacing: 0.08em;
    text-transform: uppercase;
    margin-bottom: 10px;
  }

  .match-bar-track {
    height: 8px;
    background: var(--bg4);
    border-radius: 100px;
    overflow: hidden;
  }

  .match-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--yellow), var(--yellow2));
    border-radius: 100px;
    width: 0%;
    transition: width 1.2s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .match-verdict {
    margin-top: 16px;
    font-size: 0.9rem;
    color: var(--text);
    line-height: 1.6;
    font-weight: 300;
  }

  /* Results Grid */
  .results-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }

  .result-card {
    background: var(--bg2);
    border: 1px solid var(--border2);
    border-radius: 4px;
    overflow: hidden;
  }

  .result-card-header {
    padding: 16px 24px;
    background: var(--bg3);
    border-bottom: 1px solid var(--border2);
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .result-card-title {
    font-family: 'DM Mono', monospace;
    font-size: 0.72rem;
    font-weight: 500;
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  .result-count {
    margin-left: auto;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.1rem;
    letter-spacing: 0.04em;
  }

  .result-card-body { padding: 20px 24px; }

  .skill-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 14px;
    border-radius: 100px;
    font-size: 0.78rem;
    font-weight: 500;
    margin: 4px;
    letter-spacing: 0.02em;
  }

  .pill-green { background: rgba(34,197,94,0.1); border: 1px solid rgba(34,197,94,0.25); color: var(--green); }
  .pill-red { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.25); color: var(--red); }
  .pill-orange { background: rgba(249,115,22,0.1); border: 1px solid rgba(249,115,22,0.25); color: var(--orange); }

  /* Learning Roadmap */
  .roadmap-card {
    background: var(--bg2);
    border: 1px solid var(--border2);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 20px;
  }

  .roadmap-header {
    padding: 16px 24px;
    background: var(--bg3);
    border-bottom: 1px solid var(--border2);
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .roadmap-title {
    font-family: 'DM Mono', monospace;
    font-size: 0.72rem;
    font-weight: 500;
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  .roadmap-body { padding: 24px; display: flex; flex-direction: column; gap: 16px; }

  .roadmap-item {
    background: var(--bg3);
    border: 1px solid var(--border2);
    border-radius: 4px;
    padding: 18px 20px;
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: 16px;
    align-items: start;
    transition: border-color 0.2s;
    position: relative;
    overflow: hidden;
  }

  .roadmap-item::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 3px;
  }

  .priority-high::before { background: var(--red); }
  .priority-medium::before { background: var(--orange); }
  .priority-low::before { background: var(--blue); }

  .roadmap-item:hover { border-color: var(--border); }

  .roadmap-num {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.5rem;
    color: rgba(245,196,0,0.2);
    line-height: 1;
    letter-spacing: 0.04em;
  }

  .roadmap-skill {
    font-weight: 600;
    font-size: 0.95rem;
    color: var(--text);
    margin-bottom: 4px;
  }

  .roadmap-why {
    font-size: 0.82rem;
    color: var(--muted);
    line-height: 1.6;
    margin-bottom: 10px;
    font-weight: 300;
  }

  .roadmap-resource {
    font-family: 'DM Mono', monospace;
    font-size: 0.68rem;
    color: var(--yellow);
    letter-spacing: 0.06em;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .priority-badge {
    font-family: 'DM Mono', monospace;
    font-size: 0.6rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 3px 10px;
    border-radius: 100px;
    white-space: nowrap;
  }

  .badge-high { background: rgba(239,68,68,0.1); color: var(--red); border: 1px solid rgba(239,68,68,0.2); }
  .badge-medium { background: rgba(249,115,22,0.1); color: var(--orange); border: 1px solid rgba(249,115,22,0.2); }
  .badge-low { background: rgba(59,130,246,0.1); color: var(--blue); border: 1px solid rgba(59,130,246,0.2); }

  /* Resume Tips */
  .tips-card {
    background: var(--bg2);
    border: 1px solid var(--border2);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 32px;
  }

  .tips-body { padding: 20px 24px; display: flex; flex-direction: column; gap: 12px; }

  .tip-item {
    display: flex;
    gap: 14px;
    align-items: flex-start;
    padding: 14px 16px;
    background: var(--bg3);
    border-radius: 4px;
    border: 1px solid var(--border2);
  }

  .tip-icon { font-size: 1rem; flex-shrink: 0; margin-top: 2px; }

  .tip-text {
    font-size: 0.88rem;
    color: var(--muted);
    line-height: 1.65;
    font-weight: 300;
  }

  .tip-text strong { color: var(--text); font-weight: 600; }

  /* Reset Button */
  .reset-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    background: transparent;
    border: 1px solid var(--border2);
    color: var(--muted);
    font-family: 'DM Mono', monospace;
    font-size: 0.72rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 12px 24px;
    cursor: pointer;
    transition: all 0.2s;
    margin: 0 auto;
  }

  .reset-btn:hover { border-color: var(--yellow); color: var(--yellow); }

  /* Error */
  .error-box {
    display: none;
    background: rgba(239,68,68,0.08);
    border: 1px solid rgba(239,68,68,0.25);
    border-radius: 4px;
    padding: 16px 20px;
    margin-bottom: 20px;
    font-size: 0.88rem;
    color: var(--red);
    line-height: 1.6;
  }

  .error-box.show { display: block; }

  /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
  footer {
    border-top: 1px solid var(--border2);
    padding: 20px 48px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: 'DM Mono', monospace;
    font-size: 0.65rem;
    color: var(--muted);
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (max-width: 768px) {
    header { padding: 0 20px; }
    .hero { padding: 48px 20px 36px; }
    .tool-wrapper { padding: 0 20px 60px; }
    .upload-grid { grid-template-columns: 1fr; }
    .results-grid { grid-template-columns: 1fr; }
    .match-banner { flex-direction: column; gap: 24px; padding: 24px; }
    .roadmap-item { grid-template-columns: auto 1fr; }
    .priority-badge { display: none; }
    footer { flex-direction: column; gap: 8px; text-align: center; padding: 16px 20px; }
  }
</style>
</head>
<body>

<header>
  <div class="logo">Skill<span>Gap</span> AI</div>
  <div class="header-badge">Powered by GPT-4o</div>
</header>

<div class="hero">
  <div class="hero-tag"><span class="hero-tag-dot"></span> AI-Powered Resume Analysis</div>
  <h1>Find Your <span>Skill Gaps</span><br>Land the Job</h1>
  <p>Upload your resume and a job description. Our AI will analyse what skills you're missing and give you a personalised learning roadmap.</p>
</div>

<div class="tool-wrapper">

  <div class="error-box" id="errorBox"></div>

  <!-- UPLOAD SECTION -->
  <div id="uploadSection">
    <div class="upload-grid">

      <!-- RESUME -->
      <div class="upload-card">
        <div class="upload-card-header">
          <div class="card-icon">üìÑ</div>
          <div>
            <div class="card-title">Your Resume</div>
          </div>
          <div class="card-subtitle">PDF or paste text</div>
        </div>
        <div class="drop-zone" id="resumeDropZone">
          <div class="drop-icon">üìé</div>
          <div class="drop-text">
            <strong onclick="document.getElementById('resumeFile').click()">Click to upload</strong> or drag & drop<br>
            <span style="font-size:0.75rem">PDF files supported</span>
          </div>
          <div class="file-chosen" id="resumeFileChosen" style="display:none">‚úÖ <span id="resumeFileName"></span></div>
        </div>
        <input type="file" id="resumeFile" accept=".pdf,.txt">
        <div class="or-divider"><span>or paste text</span></div>
        <textarea class="paste-area" id="resumeText" placeholder="Paste your resume content here...&#10;&#10;Include your skills, experience, education, projects etc."></textarea>
      </div>

      <!-- JOB DESCRIPTION -->
      <div class="upload-card">
        <div class="upload-card-header">
          <div class="card-icon">üíº</div>
          <div>
            <div class="card-title">Job Description</div>
          </div>
          <div class="card-subtitle">PDF or paste text</div>
        </div>
        <div class="drop-zone" id="jdDropZone">
          <div class="drop-icon">üìã</div>
          <div class="drop-text">
            <strong onclick="document.getElementById('jdFile').click()">Click to upload</strong> or drag & drop<br>
            <span style="font-size:0.75rem">PDF files supported</span>
          </div>
          <div class="file-chosen" id="jdFileChosen" style="display:none">‚úÖ <span id="jdFileName"></span></div>
        </div>
        <input type="file" id="jdFile" accept=".pdf,.txt">
        <div class="or-divider"><span>or paste text</span></div>
        <textarea class="paste-area" id="jdText" placeholder="Paste the job description here...&#10;&#10;Include required skills, responsibilities, qualifications etc."></textarea>
      </div>

    </div>

    <button class="analyse-btn" id="analyseBtn" onclick="runAnalysis()">
      Analyse My Resume <span class="btn-arrow">‚Üí</span>
    </button>
  </div>

  <!-- LOADING -->
  <div class="loading-state" id="loadingState">
    <div class="loader"></div>
    <div class="loading-text">Analysing your documents...</div>
    <div class="loading-steps">
      <div class="loading-step" id="step1"><span class="step-icon">üìÑ</span> Reading your resume</div>
      <div class="loading-step" id="step2"><span class="step-icon">üíº</span> Parsing job description</div>
      <div class="loading-step" id="step3"><span class="step-icon">üîç</span> Identifying skill gaps</div>
      <div class="loading-step" id="step4"><span class="step-icon">üó∫Ô∏è</span> Building learning roadmap</div>
      <div class="loading-step" id="step5"><span class="step-icon">‚ú®</span> Preparing your results</div>
    </div>
  </div>

  <!-- RESULTS -->
  <div class="results-section" id="resultsSection">

    <!-- Match Score -->
    <div class="match-banner">
      <div class="match-score-wrap">
        <div class="match-score" id="matchScore">0%</div>
        <div class="match-label">Match Score</div>
      </div>
      <div class="match-bar-wrap">
        <div class="match-bar-label">
          <span>Resume vs Job Requirements</span>
          <span id="matchScoreLabel">0%</span>
        </div>
        <div class="match-bar-track">
          <div class="match-bar-fill" id="matchBarFill"></div>
        </div>
        <div class="match-verdict" id="matchVerdict"></div>
      </div>
    </div>

    <!-- Skills Grid -->
    <div class="results-grid">
      <div class="result-card">
        <div class="result-card-header">
          <span>‚úÖ</span>
          <div class="result-card-title" style="color:var(--green)">Skills You Have</div>
          <div class="result-count" id="matchedCount" style="color:var(--green)">0</div>
        </div>
        <div class="result-card-body" id="matchedSkills"></div>
      </div>
      <div class="result-card">
        <div class="result-card-header">
          <span>‚ùå</span>
          <div class="result-card-title" style="color:var(--red)">Skills You're Missing</div>
          <div class="result-count" id="missingCount" style="color:var(--red)">0</div>
        </div>
        <div class="result-card-body" id="missingSkills"></div>
      </div>
    </div>

    <!-- Learning Roadmap -->
    <div class="roadmap-card">
      <div class="roadmap-header">
        <span>üó∫Ô∏è</span>
        <div class="roadmap-title">Your Learning Roadmap</div>
      </div>
      <div class="roadmap-body" id="roadmapBody"></div>
    </div>

    <!-- Resume Tips -->
    <div class="tips-card">
      <div class="result-card-header">
        <span>üí°</span>
        <div class="result-card-title" style="color:var(--yellow)">Resume Improvement Tips</div>
      </div>
      <div class="tips-body" id="tipsBody"></div>
    </div>

    <button class="reset-btn" onclick="resetTool()">‚Ü© Analyse Another Resume</button>

  </div>

</div>

<footer>
  <span>SkillGap AI ‚Äî Built for Seminar Demo</span>
  <span>Powered by OpenAI GPT-4o</span>
</footer>

<script>
  // ‚îÄ‚îÄ PDF.js setup ‚îÄ‚îÄ
  pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

  // ‚îÄ‚îÄ File handling ‚îÄ‚îÄ
  async function extractTextFromPDF(file) {
    const arrayBuffer = await file.arrayBuffer();
    const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
    let text = '';
    for (let i = 1; i <= pdf.numPages; i++) {
      const page = await pdf.getPage(i);
      const content = await page.getTextContent();
      text += content.items.map(item => item.str).join(' ') + '\n';
    }
    return text;
  }

  function setupDropZone(zoneId, fileInputId, fileChosenId, fileNameId) {
    const zone = document.getElementById(zoneId);
    const fileInput = document.getElementById(fileInputId);

    zone.addEventListener('dragover', (e) => { e.preventDefault(); zone.classList.add('dragover'); });
    zone.addEventListener('dragleave', () => zone.classList.remove('dragover'));
    zone.addEventListener('drop', async (e) => {
      e.preventDefault();
      zone.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      if (file) await handleFile(file, fileInput, fileChosenId, fileNameId, zone);
    });

    fileInput.addEventListener('change', async () => {
      if (fileInput.files[0]) await handleFile(fileInput.files[0], fileInput, fileChosenId, fileNameId, zone);
    });
  }

  async function handleFile(file, input, fileChosenId, fileNameId, zone) {
    const chosen = document.getElementById(fileChosenId);
    const nameEl = document.getElementById(fileNameId);
    nameEl.textContent = file.name;
    chosen.style.display = 'flex';
    zone.classList.add('has-file');
    zone.querySelector('.drop-icon').style.display = 'none';
    zone.querySelector('.drop-text').style.display = 'none';

    // Extract text if PDF and put into corresponding textarea
    if (file.type === 'application/pdf') {
      try {
        const text = await extractTextFromPDF(file);
        const textareaId = fileChosenId === 'resumeFileChosen' ? 'resumeText' : 'jdText';
        document.getElementById(textareaId).value = text;
      } catch(e) {
        showError('Could not read PDF. Please paste the text manually.');
      }
    }
  }

  setupDropZone('resumeDropZone', 'resumeFile', 'resumeFileChosen', 'resumeFileName');
  setupDropZone('jdDropZone', 'jdFile', 'jdFileChosen', 'jdFileName');

  // ‚îÄ‚îÄ Loading animation ‚îÄ‚îÄ
  function animateLoadingSteps() {
    const steps = ['step1','step2','step3','step4','step5'];
    steps.forEach((id, i) => {
      setTimeout(() => {
        document.getElementById(id).classList.add('show');
        if (i > 0) {
          document.getElementById(steps[i-1]).classList.add('done');
          document.getElementById(steps[i-1]).querySelector('.step-icon').textContent = '‚úÖ';
        }
      }, i * 1200);
    });
  }

  // ‚îÄ‚îÄ Error display ‚îÄ‚îÄ
  function showError(msg) {
    const box = document.getElementById('errorBox');
    box.textContent = '‚ö†Ô∏è ' + msg;
    box.classList.add('show');
    setTimeout(() => box.classList.remove('show'), 6000);
  }

  // ‚îÄ‚îÄ Main analysis ‚îÄ‚îÄ
  async function runAnalysis() {
    const resumeText = document.getElementById('resumeText').value.trim();
    const jdText = document.getElementById('jdText').value.trim();

    if (!resumeText) { showError('Please upload or paste your resume.'); return; }
    if (!jdText) { showError('Please upload or paste the job description.'); return; }

    // Show loading
    document.getElementById('uploadSection').style.display = 'none';
    document.getElementById('loadingState').classList.add('active');
    document.getElementById('resultsSection').classList.remove('active');
    animateLoadingSteps();

    try {
      const response = await fetch('/api/analyze', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ resume: resumeText, jobDescription: jdText })
      });

      if (!response.ok) {
        const err = await response.json();
        throw new Error(err.error || 'Analysis failed. Please try again.');
      }

      const data = await response.json();
      renderResults(data);

    } catch (err) {
      document.getElementById('uploadSection').style.display = 'block';
      document.getElementById('loadingState').classList.remove('active');
      showError(err.message);
    }
  }

  // ‚îÄ‚îÄ Render results ‚îÄ‚îÄ
  function renderResults(data) {
    document.getElementById('loadingState').classList.remove('active');
    document.getElementById('resultsSection').classList.add('active');

    // Match score
    const score = data.matchScore || 0;
    document.getElementById('matchScore').textContent = score + '%';
    document.getElementById('matchScoreLabel').textContent = score + '%';
    document.getElementById('matchVerdict').textContent = data.verdict || '';
    setTimeout(() => {
      document.getElementById('matchBarFill').style.width = score + '%';
    }, 100);

    // Matched skills
    const matchedEl = document.getElementById('matchedSkills');
    const matchedCount = document.getElementById('matchedCount');
    matchedEl.innerHTML = '';
    (data.matchedSkills || []).forEach(skill => {
      matchedEl.innerHTML += `<span class="skill-pill pill-green">‚úì ${skill}</span>`;
    });
    matchedCount.textContent = (data.matchedSkills || []).length;

    // Missing skills
    const missingEl = document.getElementById('missingSkills');
    const missingCount = document.getElementById('missingCount');
    missingEl.innerHTML = '';
    (data.missingSkills || []).forEach(skill => {
      missingEl.innerHTML += `<span class="skill-pill pill-red">‚úó ${skill}</span>`;
    });
    missingCount.textContent = (data.missingSkills || []).length;

    // Roadmap
    const roadmapEl = document.getElementById('roadmapBody');
    roadmapEl.innerHTML = '';
    (data.roadmap || []).forEach((item, i) => {
      const priority = item.priority?.toLowerCase() || 'medium';
      const badgeClass = priority === 'high' ? 'badge-high' : priority === 'low' ? 'badge-low' : 'badge-medium';
      const itemClass = priority === 'high' ? 'priority-high' : priority === 'low' ? 'priority-low' : 'priority-medium';
      roadmapEl.innerHTML += `
        <div class="roadmap-item ${itemClass}">
          <div class="roadmap-num">0${i+1}</div>
          <div>
            <div class="roadmap-skill">${item.skill}</div>
            <div class="roadmap-why">${item.why}</div>
            <div class="roadmap-resource">üìö ${item.resource}</div>
          </div>
          <span class="priority-badge ${badgeClass}">${item.priority}</span>
        </div>`;
    });

    // Tips
    const tipsEl = document.getElementById('tipsBody');
    tipsEl.innerHTML = '';
    (data.tips || []).forEach(tip => {
      tipsEl.innerHTML += `
        <div class="tip-item">
          <span class="tip-icon">üí°</span>
          <div class="tip-text">${tip}</div>
        </div>`;
    });
  }

  function resetTool() {
    document.getElementById('uploadSection').style.display = 'block';
    document.getElementById('resultsSection').classList.remove('active');
    document.getElementById('resumeText').value = '';
    document.getElementById('jdText').value = '';
    document.getElementById('resumeFileChosen').style.display = 'none';
    document.getElementById('jdFileChosen').style.display = 'none';
    const zones = document.querySelectorAll('.drop-zone');
    zones.forEach(z => {
      z.classList.remove('has-file','dragover');
      z.querySelector('.drop-icon').style.display = '';
      z.querySelector('.drop-text').style.display = '';
    });
    const steps = ['step1','step2','step3','step4','step5'];
    steps.forEach(id => {
      const el = document.getElementById(id);
      el.classList.remove('show','done');
    });
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
</script>
</body>
</html>
